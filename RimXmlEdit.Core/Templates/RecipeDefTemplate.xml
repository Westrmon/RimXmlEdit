<?xml version="1.0" encoding="utf-8"?>
<Defs xmlns:meta="RimXmlEdit.Template"
    meta:defType="RecipeDef">

    <!-- 可用过滤器定义 -->
    <meta:FilterDefs>
        <meta:Filter Name="IsCraftingRecipe" Desc="是否为常规制作配方（例如加工台制作）" />
        <meta:Filter Name="IsCookingRecipe" Desc="是否为烹饪配方（例如生火做饭、电炉烹饪）" />
        <meta:Filter Name="IsSmithingRecipe" Desc="是否为锻造配方（例如锻造台）" />
        <meta:Filter Name="IsTailoringRecipe" Desc="是否为缝纫配方（例如裁缝台）" />
        <meta:Filter Name="IsDrugRecipe" Desc="是否为药物加工配方（例如药物实验台）" />
        <meta:Filter Name="RequiresResearch" Desc="配方是否需要研究解锁" />
    </meta:FilterDefs>

    <!-- ======================== -->
    <!--       配方模板定义       -->
    <!-- ======================== -->
    <RecipeDef meta:Name="CustomRecipeTemplate"
        meta:Desc="可条件切换的通用制作配方模板"
        ParentName="RecipeDef">

        <!-- 基础字段 -->
        <defName>MyCustomRecipe</defName>
        <label>Custom Recipe</label>
        <jobString>正在制作物品…</jobString>

        <!-- 工作量与技能系统 -->
        <workAmount>1000</workAmount>

        <!-- 根据类型切换速度属性 -->
        <workSpeedStat meta:If="IsCookingRecipe">CookingSpeed</workSpeedStat>
        <workSpeedStat meta:If="IsSmithingRecipe">SmithingSpeed</workSpeedStat>
        <workSpeedStat meta:If="IsTailoringRecipe">TailoringSpeed</workSpeedStat>
        <workSpeedStat meta:If="IsDrugRecipe">DrugSynthesisSpeed</workSpeedStat>

        <!-- 默认制作速度（如果没有特别指定） -->
        <workSpeedStat meta:Unless="IsCookingRecipe|IsSmithingRecipe|IsTailoringRecipe|IsDrugRecipe">
            WorkSpeedGlobal
        </workSpeedStat>

        <workSkill>Crafting</workSkill>
        <workSkillLearnFactor>0.5</workSkillLearnFactor>

        <!-- 材料过滤 -->
        <defaultIngredientFilter>
            <thingDefs>
                <li>Steel</li>
                <li meta:If="IsCookingRecipe">MeatRaw</li>
                <li meta:If="IsDrugRecipe">HerbalMedicine</li>
            </thingDefs>
        </defaultIngredientFilter>

        <fixedIngredientFilter>
            <thingDefs>
                <li meta:If="IsCookingRecipe">VegetarianRaw</li>
            </thingDefs>
        </fixedIngredientFilter>

        <!-- 材料列表 -->
        <ingredients>
            <li>
                <filter>
                    <thingDefs>
                        <li>Steel</li>
                    </thingDefs>
                </filter>
                <count>10</count>
            </li>

            <li meta:If="IsCookingRecipe">
                <filter>
                    <thingDefs>
                        <li>MeatRaw</li>
                    </thingDefs>
                </filter>
                <count>5</count>
            </li>
        </ingredients>

        <!-- 产物 -->
        <products>
            <MyProduct>1</MyProduct>
            <MealSimple meta:If="IsCookingRecipe">1</MealSimple>
        </products>

        <!-- 工作台（根据配方类型切换） -->
        <recipeUsers>
            <li meta:If="IsCraftingRecipe">TableMachining</li>
            <li meta:If="IsCookingRecipe">ElectricStove</li>
            <li meta:If="IsSmithingRecipe">FueledSmithy</li>
            <li meta:If="IsTailoringRecipe">TailoringBench</li>
            <li meta:If="IsDrugRecipe">DrugLab</li>
        </recipeUsers>

        <!-- 研究前置 -->
        <researchPrerequisite meta:If="RequiresResearch">MicroelectronicsBasics</researchPrerequisite>

    </RecipeDef>
</Defs>