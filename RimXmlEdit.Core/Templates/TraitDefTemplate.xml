<?xml version="1.0" encoding="utf-8"?>
<Defs xmlns:meta="RimXmlEdit.Template"
    meta:defType="TraitDef">

    <!-- ======================== -->
    <!--       可用过滤器定义       -->
    <!-- ======================== -->
    <meta:FilterDefs>
        <meta:Filter Name="IsPositiveTrait" Desc="是否为积极特性（积极效果）" />
        <meta:Filter Name="IsNegativeTrait" Desc="是否为消极特性（负面效果）" />
        <meta:Filter Name="AffectsSkills" Desc="是否会改变技能数值" />
        <meta:Filter Name="AffectsSocial" Desc="是否影响社交关系、浪漫、社交战斗" />
        <meta:Filter Name="HasDegrees" Desc="是否拥有多个等级（degreeDatas）" />
    </meta:FilterDefs>

    <!-- ======================== -->
    <!--        特性模板定义        -->
    <!-- ======================== -->
    <TraitDef meta:Name="CustomTraitTemplate"
        meta:Desc="一个可根据过滤器组合生成不同特性的模板"
        ParentName="TraitDef">

        <!-- 基础信息 -->
        <defName>MyCustomTrait</defName>
        <label>Custom Trait</label>
        <description>这是一个自定义的特性模板示例。</description>

        <!-- 出现概率（积极与消极可有不同权重） -->
        <commonality meta:If="IsPositiveTrait">1.5</commonality>
        <commonality meta:If="IsNegativeTrait">0.8</commonality>
        <commonality meta:Unless="IsPositiveTrait|IsNegativeTrait">1.0</commonality>

        <!-- ======================== -->
        <!--       多等级定义块        -->
        <!-- ======================== -->
        <degreeDatas meta:If="HasDegrees">
            <li>
                <degree>1</degree>
                <label>Minor</label>
                <description>轻微版本的效果。</description>
                <statOffsets>
                    <MoodOffset>2</MoodOffset>
                </statOffsets>
            </li>
            <li>
                <degree>2</degree>
                <label>Major</label>
                <description>更强烈的效果版本。</description>
                <statOffsets>
                    <MoodOffset>5</MoodOffset>
                </statOffsets>
            </li>
        </degreeDatas>

        <!-- ======================== -->
        <!--        特性数值效果       -->
        <!-- ======================== -->

        <!-- 属性偏移（示例：移动速度、全局心情等） -->
        <statOffsets>
            <MoveSpeed meta:If="IsPositiveTrait">0.15</MoveSpeed>
            <MoveSpeed meta:If="IsNegativeTrait">-0.10</MoveSpeed>
            <MoodOffset meta:If="IsPositiveTrait">3</MoodOffset>
            <MoodOffset meta:If="IsNegativeTrait">-5</MoodOffset>
        </statOffsets>

        <!-- 技能增益 -->
        <skillGains meta:If="AffectsSkills">
            <Cooking>3</Cooking>
            <Shooting meta:If="IsNegativeTrait">-2</Shooting>
        </skillGains>

        <!-- 精神崩溃概率曲线（通常用于心情影响较强的特性） -->
        <mentalBreakMtbDaysMoodCurve>
            <points>
                <li>
                    <x>0.1</x>
                    <y>0.5</y>
                </li>
                <li>
                    <x>0.5</x>
                    <y>1.0</y>
                </li>
            </points>
        </mentalBreakMtbDaysMoodCurve>

        <!-- 允许的精神崩溃（自定义行为） -->
        <allowedMentalBreaks>
            <li>SadWander</li>
            <li meta:If="IsNegativeTrait">Berserk</li>
        </allowedMentalBreaks>

        <!-- ======================== -->
        <!--      冲突 & 要求特性      -->
        <!-- ======================== -->
        <conflictingTraits>
            <li>Courageous</li>
            <li meta:If="IsNegativeTrait">Optimist</li>
        </conflictingTraits>

        <requiredTraits>
            <li meta:If="IsPositiveTrait">Kind</li>
        </requiredTraits>

        <!-- 强制喜欢或讨厌的工作类型 -->
        <requiredWorkTypes>
            <li meta:If="IsPositiveTrait">Social</li>
        </requiredWorkTypes>

        <disallowedWorkTypes>
            <li meta:If="IsNegativeTrait">Violent</li>
        </disallowedWorkTypes>

        <!-- ======================== -->
        <!--        社交相关效果        -->
        <!-- ======================== -->
        <socialFightChanceFactor meta:If="AffectsSocial">1.2</socialFightChanceFactor>
        <romanceChanceFactor meta:If="AffectsSocial">1.4</romanceChanceFactor>

    </TraitDef>
</Defs>