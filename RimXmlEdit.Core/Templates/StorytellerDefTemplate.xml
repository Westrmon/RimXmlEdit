<?xml version="1.0" encoding="utf-8"?>
<Defs xmlns:meta="RimXmlEdit.Template"
    meta:defType="StorytellerDef">

    <!-- =============================== -->
    <!--        可用过滤器定义区         -->
    <!-- =============================== -->
    <meta:FilterDefs>
        <meta:Filter Name="IsBaseStoryteller" Desc="是否为游戏原版基础叙事者（如Cassandra、Phoebe、Randy）。" />
        <meta:Filter Name="IsCustomStoryteller" Desc="是否为自定义叙事者。" />
        <meta:Filter Name="IsPeaceful" Desc="叙事者是否专注于和平、低威胁事件。" />
        <meta:Filter Name="IsRandom" Desc="叙事者事件是否完全随机（如 Randy）。" />
        <meta:Filter Name="ControlsThreats" Desc="叙事者是否参与威胁事件的控制逻辑。" />
        <meta:Filter Name="ControlsEvents" Desc="叙事者是否控制一般事件的生成行为。" />
    </meta:FilterDefs>

    <!-- ================================================== -->
    <!--          自定义叙事者模板（可切换风格）           -->
    <!-- ================================================== -->
    <StorytellerDef meta:Name="CustomStoryteller"
        meta:Desc="可用于生成自定义叙事者，支持随机型、和平型、经典型等多种风格。">

        <!-- 基础信息 -->
        <defName>MyCustomStoryteller</defName>
        <label>Custom Storyteller</label>
        <description>一个可通过模板系统动态切换行为与事件风格的自定义叙事者。</description>

        <portrait>UI/Storytellers/Perry</portrait>
        <portraitColor>
            <r>1</r>
            <g>1</g>
            <b>1</b>
            <a>1</a>
        </portraitColor>

        <!-- 列表显示顺序 -->
        <listOrder>100</listOrder>

        <!-- ===================== -->
        <!--      难度设置         -->
        <!-- ===================== -->

        <difficultyTags>
            <li meta:If="IsPeaceful">Peaceful</li>
            <li meta:Unless="IsPeaceful">Standard</li>
            <li meta:If="IsRandom">Randomness</li>
        </difficultyTags>

        <!-- 禁用某些游戏机制 -->
        <disableAdaptiveTraining meta:If="IsPeaceful">true</disableAdaptiveTraining>
        <disableRandomDisease meta:If="IsPeaceful">true</disableRandomDisease>

        <disableExtremeWeatherIncidents meta:If="IsPeaceful">true</disableExtremeWeatherIncidents>
        <disableExtremeWeatherIncidents meta:If="IsRandom">false</disableExtremeWeatherIncidents>

        <!-- ===================== -->
        <!--      事件控制         -->
        <!-- ===================== -->

        <!-- 事件选择权重（随机型叙事者更高） -->
        <baseIncidentSelectionWeight meta:If="IsRandom">2.0</baseIncidentSelectionWeight>
        <baseIncidentSelectionWeight meta:Unless="IsRandom">1.0</baseIncidentSelectionWeight>

        <!-- 可候选事件列表 -->
        <incidentCandidates meta:If="ControlsEvents">
            <li>
                <category>ThreatBig</category>
                <weight meta:If="IsPeaceful">0.0</weight>
                <weight meta:Unless="IsPeaceful">1.0</weight>
            </li>
            <li>
                <category>ThreatSmall</category>
                <weight meta:If="IsPeaceful">0.2</weight>
                <weight meta:Unless="IsPeaceful">1.0</weight>
            </li>
            <li>
                <category>Misc</category>
                <weight>1.0</weight>
            </li>
        </incidentCandidates>

        <!-- 适应性天数设置 -->
        <adaptDaysMin meta:If="ControlsEvents">5</adaptDaysMin>
        <adaptDaysMax meta:If="ControlsEvents">20</adaptDaysMax>

        <!-- ===================== -->
        <!--      威胁节奏控制     -->
        <!-- ===================== -->

        <minThreatBigIntervalDays meta:If="ControlsThreats">10</minThreatBigIntervalDays>
        <maxThreatBigIntervalDays meta:If="ControlsThreats">30</maxThreatBigIntervalDays>

        <minThreatSmallIntervalDays meta:If="ControlsThreats">3</minThreatSmallIntervalDays>
        <maxThreatSmallIntervalDays meta:If="ControlsThreats">15</maxThreatSmallIntervalDays>

        <!-- ===================== -->
        <!--     叙事者风格示例    -->
        <!-- ===================== -->

        <!-- Cassandra：倾向平衡递增威胁 -->
        <baseIncidentSelectionWeight meta:If="IsBaseStoryteller">1.2</baseIncidentSelectionWeight>

        <!-- Phoebe：和平较多，威胁较少 -->
        <minThreatBigIntervalDays meta:If="IsPeaceful">20</minThreatBigIntervalDays>
        <maxThreatBigIntervalDays meta:If="IsPeaceful">50</maxThreatBigIntervalDays>

        <!-- Randy：完全随机，不受传统威胁间隔限制 -->
        <minThreatBigIntervalDays meta:If="IsRandom">0</minThreatBigIntervalDays>
        <maxThreatBigIntervalDays meta:If="IsRandom">999</maxThreatBigIntervalDays>

        <!-- Perry Persistent：自定义特性 -->
        <incidentCandidates meta:If="IsCustomStoryteller">
            <li>
                <category>CustomEvent</category>
                <weight>1.5</weight>
            </li>
        </incidentCandidates>

    </StorytellerDef>
</Defs>